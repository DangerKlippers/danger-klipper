
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="Resonance_Compensation.html">
      
      
        <link rel="next" href="Pressure_Advance.html">
      
      
      <link rel="icon" href="img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.23">
    
    
      
        <title>Measuring Resonances - Danger Klipper documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="_klipper3d/css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-3YZJ9658GV"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-3YZJ9658GV",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-3YZJ9658GV",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#measuring-resonances" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Danger Klipper documentation" class="md-header__button md-logo" aria-label="Danger Klipper documentation" data-md-component="logo">
      
  <img src="img/klipper.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Danger Klipper documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Measuring Resonances
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2 0-.68.06-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.923 7.923 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8.008 8.008 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.65 15.65 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/DangerKlippers/danger-klipper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    DangerKlippers/danger-klipper
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Danger Klipper documentation" class="md-nav__button md-logo" aria-label="Danger Klipper documentation" data-md-component="logo">
      
  <img src="img/klipper.svg" alt="logo">

    </a>
    Danger Klipper documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DangerKlippers/danger-klipper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    DangerKlippers/danger-klipper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Danger_Features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Danger Klipper additions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently Asked Questions
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Config_Changes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Changes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Contact.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation and Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Installation and Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Installation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="OctoPrint.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OctoPrint for Klipper
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Configuration Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Config_Reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Rotation_Distance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rotation distance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Config_checks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration checks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bed Level
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Bed Level
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bed_Level.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bed leveling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Delta_Calibrate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delta calibration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Probe_Calibrate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probe calibration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="BLTouch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BL-Touch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Manual_Level.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual leveling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bed_Mesh.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bed Mesh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Endstop_Phase.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endstop phase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Axis_Twist_Compensation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Axis Twist Compensation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5" checked>
        
          
          <label class="md-nav__link" for="__nav_8_5" id="__nav_8_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resonance Compensation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_5">
            <span class="md-nav__icon md-icon"></span>
            Resonance Compensation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Resonance_Compensation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resonance Compensation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Measuring Resonances
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Measuring_Resonances.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Measuring Resonances
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mcus-with-klipper-i2c-fast-mode-support" class="md-nav__link">
    <span class="md-ellipsis">
      MCUs with Klipper I2C fast-mode Support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Installation instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wiring" class="md-nav__link">
    <span class="md-ellipsis">
      Wiring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi-accelerometers" class="md-nav__link">
    <span class="md-ellipsis">
      SPI Accelerometers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SPI Accelerometers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adxl345" class="md-nav__link">
    <span class="md-ellipsis">
      ADXL345
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ADXL345">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direct-to-raspberry-pi" class="md-nav__link">
    <span class="md-ellipsis">
      Direct to Raspberry Pi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-raspberry-pi-pico" class="md-nav__link">
    <span class="md-ellipsis">
      Using Raspberry Pi Pico
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i2c-accelerometers" class="md-nav__link">
    <span class="md-ellipsis">
      I2C Accelerometers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I2C Accelerometers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500" class="md-nav__link">
    <span class="md-ellipsis">
      MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-connection-scheme-for-i2ctwi-on-the-avr-atmega328p-arduino-nano" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended connection scheme for I2C(TWI) on the AVR ATmega328P Arduino Nano:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mounting-the-accelerometer" class="md-nav__link">
    <span class="md-ellipsis">
      Mounting the accelerometer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Software installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-adxl345-with-rpi" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ADXL345 With RPi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-adxl345-with-pi-pico" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ADXL345 With Pi Pico
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configure ADXL345 With Pi Pico">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flash-the-pico-firmware" class="md-nav__link">
    <span class="md-ellipsis">
      Flash the Pico Firmware
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-the-connection" class="md-nav__link">
    <span class="md-ellipsis">
      Configure the Connection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-lis2dw-series" class="md-nav__link">
    <span class="md-ellipsis">
      Configure LIS2DW series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-mpu-60009000-series-with-rpi" class="md-nav__link">
    <span class="md-ellipsis">
      Configure MPU-6000/9000 series With RPi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-mpu-9520-compatibles-with-pico" class="md-nav__link">
    <span class="md-ellipsis">
      Configure MPU-9520 Compatibles With Pico
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-mpu-9520-compatibles-with-avr" class="md-nav__link">
    <span class="md-ellipsis">
      Configure MPU-9520 Compatibles with AVR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#measuring-the-resonances" class="md-nav__link">
    <span class="md-ellipsis">
      Measuring the resonances
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Measuring the resonances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-the-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Checking the setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measuring-the-resonances_1" class="md-nav__link">
    <span class="md-ellipsis">
      Measuring the resonances
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed-slinger-printers" class="md-nav__link">
    <span class="md-ellipsis">
      Bed-slinger printers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-smoothing" class="md-nav__link">
    <span class="md-ellipsis">
      Max smoothing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-max_accel" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting max_accel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-custom-axes" class="md-nav__link">
    <span class="md-ellipsis">
      Testing custom axes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-shaper-auto-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      Input Shaper auto-calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Shaper auto-calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-shaper-re-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      Input Shaper re-calibration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#offline-processing-of-the-accelerometer-data" class="md-nav__link">
    <span class="md-ellipsis">
      Offline processing of the accelerometer data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Pressure_Advance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pressure advance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="G-Codes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    G-Codes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_8" >
        
          
          <label class="md-nav__link" for="__nav_8_8" id="__nav_8_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Command templates
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_8">
            <span class="md-nav__icon md-icon"></span>
            Command templates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Command_Templates.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commands templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Status_Reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Status reference
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TMC_Drivers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TMC drivers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multi_MCU_Homing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Micro-controller Homing and Probing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Slicers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slicers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Skew_Correction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skew correction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Exclude_Object.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exclude Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Using_PWM_Tools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using PWM tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Developer Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Code_Overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Kinematics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kinematics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Protocol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="API_Server.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="MCU_Commands.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MCU commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CANBUS_protocol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CANBUS protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Debugging.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Benchmarks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CONTRIBUTING.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing to Danger-Klipper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Packaging.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Packaging Klipper
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Device Specific Documents
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Device Specific Documents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Example_Configs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SDCard_Updates.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDCard updates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="RPi_microcontroller.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPi microcontroller
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Beaglebone.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beaglebone
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bootloaders.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootloaders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bootloader_Entry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootloader Entry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CANBUS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CANBUS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CANBUS_Troubleshooting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CANBUS Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TSL1401CL_Filament_Width_Sensor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TSL1401CL filament width sensor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Hall_Filament_Width_Sensor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hall filament width sensor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Eddy_Probe.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eddy Current Inductive probe
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Sponsors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sponsors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mcus-with-klipper-i2c-fast-mode-support" class="md-nav__link">
    <span class="md-ellipsis">
      MCUs with Klipper I2C fast-mode Support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Installation instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wiring" class="md-nav__link">
    <span class="md-ellipsis">
      Wiring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi-accelerometers" class="md-nav__link">
    <span class="md-ellipsis">
      SPI Accelerometers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SPI Accelerometers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adxl345" class="md-nav__link">
    <span class="md-ellipsis">
      ADXL345
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ADXL345">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direct-to-raspberry-pi" class="md-nav__link">
    <span class="md-ellipsis">
      Direct to Raspberry Pi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-raspberry-pi-pico" class="md-nav__link">
    <span class="md-ellipsis">
      Using Raspberry Pi Pico
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i2c-accelerometers" class="md-nav__link">
    <span class="md-ellipsis">
      I2C Accelerometers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I2C Accelerometers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500" class="md-nav__link">
    <span class="md-ellipsis">
      MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-connection-scheme-for-i2ctwi-on-the-avr-atmega328p-arduino-nano" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended connection scheme for I2C(TWI) on the AVR ATmega328P Arduino Nano:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mounting-the-accelerometer" class="md-nav__link">
    <span class="md-ellipsis">
      Mounting the accelerometer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Software installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-adxl345-with-rpi" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ADXL345 With RPi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-adxl345-with-pi-pico" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ADXL345 With Pi Pico
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configure ADXL345 With Pi Pico">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flash-the-pico-firmware" class="md-nav__link">
    <span class="md-ellipsis">
      Flash the Pico Firmware
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-the-connection" class="md-nav__link">
    <span class="md-ellipsis">
      Configure the Connection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-lis2dw-series" class="md-nav__link">
    <span class="md-ellipsis">
      Configure LIS2DW series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-mpu-60009000-series-with-rpi" class="md-nav__link">
    <span class="md-ellipsis">
      Configure MPU-6000/9000 series With RPi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-mpu-9520-compatibles-with-pico" class="md-nav__link">
    <span class="md-ellipsis">
      Configure MPU-9520 Compatibles With Pico
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-mpu-9520-compatibles-with-avr" class="md-nav__link">
    <span class="md-ellipsis">
      Configure MPU-9520 Compatibles with AVR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#measuring-the-resonances" class="md-nav__link">
    <span class="md-ellipsis">
      Measuring the resonances
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Measuring the resonances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-the-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Checking the setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measuring-the-resonances_1" class="md-nav__link">
    <span class="md-ellipsis">
      Measuring the resonances
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bed-slinger-printers" class="md-nav__link">
    <span class="md-ellipsis">
      Bed-slinger printers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-smoothing" class="md-nav__link">
    <span class="md-ellipsis">
      Max smoothing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-max_accel" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting max_accel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-custom-axes" class="md-nav__link">
    <span class="md-ellipsis">
      Testing custom axes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-shaper-auto-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      Input Shaper auto-calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Input Shaper auto-calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-shaper-re-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      Input Shaper re-calibration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#offline-processing-of-the-accelerometer-data" class="md-nav__link">
    <span class="md-ellipsis">
      Offline processing of the accelerometer data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <div class="md-banner md-banner--warning">
  <div class="md-banner__content">
    🚨 The <strong>Danger-Klipper</strong> project has been renamed to <strong>Kalico</strong>.
    Visit the new repository:
    <a href="https://github.com/KalicoCrew/kalico" class="md-banner__link">Kalico on GitHub</a>.
  </div>
</div>

  
                  

  
  


<h1 id="measuring-resonances">Measuring Resonances<a class="headerlink" href="#measuring-resonances" title="Permanent link">&para;</a></h1>
<p>Klipper has built-in support for the ADXL345, MPU-9250 and LIS2DW compatible
accelerometers which can be used to measure resonance frequencies of the printer
for different axes, and auto-tune <a href="Resonance_Compensation.html">input shapers</a> to
compensate for resonances. Note that using accelerometers requires some
soldering and crimping. The ADXL345/LIS2DW can be connected to the SPI interface
of a Raspberry Pi or MCU board (it needs to be reasonably fast). The MPU family can
be connected to the I2C interface of a Raspberry Pi directly, or to an I2C
interface of an MCU board that supports 400kbit/s <em>fast mode</em> in Klipper.</p>
<p>When sourcing accelerometers, be aware that there are a variety of different PCB
board designs and different clones of them. If it is going to be connected to a
5V printer MCU ensure it has a voltage regulator and level shifters.</p>
<p>For ADXL345s/LIS2DWs, make sure that the board supports SPI mode (a small number of
boards appear to be hard-configured for I2C by pulling SDO to GND).</p>
<p>For MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500s there are also a variety of
board designs and clones with different I2C pull-up resistors which will need
supplementing.</p>
<h2 id="mcus-with-klipper-i2c-fast-mode-support">MCUs with Klipper I2C <em>fast-mode</em> Support<a class="headerlink" href="#mcus-with-klipper-i2c-fast-mode-support" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th style="text-align: center;">MCU Family</th>
<th style="text-align: left;">MCU(s) Tested</th>
<th style="text-align: left;">MCU(s) with Support</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Raspberry Pi</td>
<td style="text-align: left;">3B+, Pico</td>
<td style="text-align: left;">3A, 3A+, 3B, 4</td>
</tr>
<tr>
<td style="text-align: center;">AVR ATmega</td>
<td style="text-align: left;">ATmega328p</td>
<td style="text-align: left;">ATmega32u4, ATmega128, ATmega168, ATmega328, ATmega644p, ATmega1280, ATmega1284, ATmega2560</td>
</tr>
<tr>
<td style="text-align: center;">AVR AT90</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">AT90usb646, AT90usb1286</td>
</tr>
</tbody>
</table>
<h2 id="installation-instructions">Installation instructions<a class="headerlink" href="#installation-instructions" title="Permanent link">&para;</a></h2>
<h3 id="wiring">Wiring<a class="headerlink" href="#wiring" title="Permanent link">&para;</a></h3>
<p>An ethernet cable with shielded twisted pairs (cat5e or better) is recommended
for signal integrity over a long distance. If you still experience signal
integrity issues (SPI/I2C errors):</p>
<ul>
<li>Double check the wiring with a digital multimeter for:<ul>
<li>Correct connections when turned off (continuity)</li>
<li>Correct power and ground voltages</li>
</ul>
</li>
<li>I2C only:<ul>
<li>Check the SCL and SDA lines' resistances to 3.3V are in the range of 900
  ohms to 1.8K</li>
<li>For full technical details consult <a href="https://www.pololu.com/file/0J435/UM10204.pdf">chapter 7 of the I2C-bus specification
  and user manual UM10204</a>
  for <em>fast-mode</em></li>
</ul>
</li>
<li>Shorten the cable</li>
</ul>
<p>Connect ethernet cable shielding only to the MCU board/Pi ground.</p>
<p><strong><em>Double-check your wiring before powering up to prevent
damaging your MCU/Raspberry Pi or the accelerometer.</em></strong></p>
<h3 id="spi-accelerometers">SPI Accelerometers<a class="headerlink" href="#spi-accelerometers" title="Permanent link">&para;</a></h3>
<p>Suggested twisted pair order for three twisted pairs:</p>
<div class="highlight"><pre><span></span><code>GND+MISO
3.3V+MOSI
SCLK+CS
</code></pre></div>

<p>Note that unlike a cable shield, GND must be connected at both ends.</p>
<h4 id="adxl345">ADXL345<a class="headerlink" href="#adxl345" title="Permanent link">&para;</a></h4>
<h5 id="direct-to-raspberry-pi">Direct to Raspberry Pi<a class="headerlink" href="#direct-to-raspberry-pi" title="Permanent link">&para;</a></h5>
<p><strong>Note: Many MCUs will work with an ADXL345 in SPI mode (e.g. Pi Pico), wiring
and configuration will vary according to your specific board and available
pins.</strong></p>
<p>You need to connect ADXL345 to your Raspberry Pi via SPI. Note that the I2C
connection, which is suggested by ADXL345 documentation, has too low throughput
and <strong>will not work</strong>. The recommended connection scheme:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">ADXL345 pin</th>
<th style="text-align: center;">RPi pin</th>
<th style="text-align: center;">RPi pin name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">3V3 (or VCC)</td>
<td style="text-align: center;">01</td>
<td style="text-align: center;">3.3V DC power</td>
</tr>
<tr>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">06</td>
<td style="text-align: center;">Ground</td>
</tr>
<tr>
<td style="text-align: center;">CS</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">GPIO08 (SPI0_CE0_N)</td>
</tr>
<tr>
<td style="text-align: center;">SDO</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">GPIO09 (SPI0_MISO)</td>
</tr>
<tr>
<td style="text-align: center;">SDA</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">GPIO10 (SPI0_MOSI)</td>
</tr>
<tr>
<td style="text-align: center;">SCL</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">GPIO11 (SPI0_SCLK)</td>
</tr>
</tbody>
</table>
<p>Fritzing wiring diagrams for some of the ADXL345 boards:</p>
<p><img alt="ADXL345-Rpi" src="img/adxl345-fritzing.png" /></p>
<h5 id="using-raspberry-pi-pico">Using Raspberry Pi Pico<a class="headerlink" href="#using-raspberry-pi-pico" title="Permanent link">&para;</a></h5>
<p>You may connect the ADXL345 to your Raspberry Pi Pico and then connect the
Pico to your Raspberry Pi via USB. This makes it easy to reuse the
accelerometer on other Klipper devices, as you can connect via USB instead
of GPIO. The Pico does not have much processing power, so make sure it is
only running the accelerometer and not performing any other duties.</p>
<p>In order to avoid damage to your RPi make sure to connect the ADXL345 to 3.3V
only. Depending on the board's layout, a level shifter may be present, which
makes 5V dangerous for your RPi.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">ADXL345 pin</th>
<th style="text-align: center;">Pico pin</th>
<th style="text-align: center;">Pico pin name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">3V3 (or VCC)</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">3.3V DC power</td>
</tr>
<tr>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">Ground</td>
</tr>
<tr>
<td style="text-align: center;">CS</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">GP1 (SPI0_CSn)</td>
</tr>
<tr>
<td style="text-align: center;">SDO</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">GP0 (SPI0_RX)</td>
</tr>
<tr>
<td style="text-align: center;">SDA</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">GP3 (SPI0_TX)</td>
</tr>
<tr>
<td style="text-align: center;">SCL</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">GP2 (SPI0_SCK)</td>
</tr>
</tbody>
</table>
<p>Wiring diagrams for some of the ADXL345 boards:</p>
<p><img alt="ADXL345-Pico" src="img/adxl345-pico.png" /></p>
<h3 id="i2c-accelerometers">I2C Accelerometers<a class="headerlink" href="#i2c-accelerometers" title="Permanent link">&para;</a></h3>
<p>Suggested twisted pair order for three pairs (preferred):</p>
<div class="highlight"><pre><span></span><code>3.3V+GND
SDA+GND
SCL+GND
</code></pre></div>

<p>or for two pairs:</p>
<div class="highlight"><pre><span></span><code>3.3V+SDA
GND+SCL
</code></pre></div>

<p>Note that unlike a cable shield, any GND(s) should be connected at both ends.</p>
<h4 id="mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500">MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500<a class="headerlink" href="#mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500" title="Permanent link">&para;</a></h4>
<p>These accelerometers have been tested to work over I2C on the RPi, RP2040 (Pico)
and AVR at 400kbit/s (<em>fast mode</em>). Some MPU accelerometer modules include
pull-ups, but some are too large at 10K and must be changed or supplemented by
smaller parallel resistors.</p>
<p>Recommended connection scheme for I2C on the Raspberry Pi:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">MPU-9250 pin</th>
<th style="text-align: center;">RPi pin</th>
<th style="text-align: center;">RPi pin name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">VCC</td>
<td style="text-align: center;">01</td>
<td style="text-align: center;">3.3v DC power</td>
</tr>
<tr>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">09</td>
<td style="text-align: center;">Ground</td>
</tr>
<tr>
<td style="text-align: center;">SDA</td>
<td style="text-align: center;">03</td>
<td style="text-align: center;">GPIO02 (SDA1)</td>
</tr>
<tr>
<td style="text-align: center;">SCL</td>
<td style="text-align: center;">05</td>
<td style="text-align: center;">GPIO03 (SCL1)</td>
</tr>
</tbody>
</table>
<p>The RPi has buit-in 1.8K pull-ups on both SCL and SDA.</p>
<p><img alt="MPU-9250 connected to Pi" src="img/mpu9250-PI-fritzing.png" /></p>
<p>Recommended connection scheme for I2C (i2c0a) on the RP2040:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">MPU-9250 pin</th>
<th style="text-align: center;">RP2040 pin</th>
<th style="text-align: center;">RP2040 pin name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">VCC</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">3v3</td>
</tr>
<tr>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">Ground</td>
</tr>
<tr>
<td style="text-align: center;">SDA</td>
<td style="text-align: center;">01</td>
<td style="text-align: center;">GP0 (I2C0 SDA)</td>
</tr>
<tr>
<td style="text-align: center;">SCL</td>
<td style="text-align: center;">02</td>
<td style="text-align: center;">GP1 (I2C0 SCL)</td>
</tr>
</tbody>
</table>
<p>The Pico does not include any built-in I2C pull-up resistors.</p>
<p><img alt="MPU-9250 connected to Pico" src="img/mpu9250-PICO-fritzing.png" /></p>
<h5 id="recommended-connection-scheme-for-i2ctwi-on-the-avr-atmega328p-arduino-nano">Recommended connection scheme for I2C(TWI) on the AVR ATmega328P Arduino Nano:<a class="headerlink" href="#recommended-connection-scheme-for-i2ctwi-on-the-avr-atmega328p-arduino-nano" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th style="text-align: center;">MPU-9250 pin</th>
<th style="text-align: center;">Atmega328P TQFP32 pin</th>
<th style="text-align: center;">Atmega328P pin name</th>
<th style="text-align: center;">Arduino Nano pin</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">VCC</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr>
<td style="text-align: center;">GND</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">Ground</td>
<td style="text-align: center;">GND</td>
</tr>
<tr>
<td style="text-align: center;">SDA</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">SDA</td>
<td style="text-align: center;">A4</td>
</tr>
<tr>
<td style="text-align: center;">SCL</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">SCL</td>
<td style="text-align: center;">A5</td>
</tr>
</tbody>
</table>
<p>The Arduino Nano does not include any built-in pull-up resistors nor a 3.3V
power pin.</p>
<h3 id="mounting-the-accelerometer">Mounting the accelerometer<a class="headerlink" href="#mounting-the-accelerometer" title="Permanent link">&para;</a></h3>
<p>The accelerometer must be attached to the toolhead. One needs to design a proper
mount that fits their own 3D printer. It is better to align the axes of the
accelerometer with the printer's axes (but if it makes it more convenient,
axes can be swapped - i.e. no need to align X axis with X and so forth - it
should be fine even if Z axis of accelerometer is X axis of the printer, etc.).</p>
<p>An example of mounting ADXL345 on the SmartEffector:</p>
<p><img alt="ADXL345 on SmartEffector" src="img/adxl345-mount.jpg" /></p>
<p>Note that on a bed slinger printer one must design 2 mounts: one for the
toolhead and one for the bed, and run the measurements twice. See the
corresponding <a href="#bed-slinger-printers">section</a> for more details.</p>
<p><strong>Attention:</strong> make sure the accelerometer and any screws that hold it in
place do not touch any metal parts of the printer. Basically, the mount must
be designed such as to ensure the electrical isolation of the accelerometer
from the printer frame. Failing to ensure that can create a ground loop in
the system that may damage the electronics.</p>
<h3 id="software-installation">Software installation<a class="headerlink" href="#software-installation" title="Permanent link">&para;</a></h3>
<p>Note that resonance measurements and shaper auto-calibration require additional
software dependencies not installed by default. First, run on your Raspberry Pi
the following commands:</p>
<div class="highlight"><pre><span></span><code>sudo apt update
sudo apt install python3-numpy python3-matplotlib libatlas-base-dev libopenblas-dev
</code></pre></div>

<p>Next, in order to install NumPy in the Klipper environment, run the command:</p>
<div class="highlight"><pre><span></span><code>~/klippy-env/bin/pip install -v numpy
</code></pre></div>

<p>Note that, depending on the performance of the CPU, it may take <em>a lot</em>
of time, up to 10-20 minutes. Be patient and wait for the completion of
the installation. On some occasions, if the board has too little RAM
the installation may fail and you will need to enable swap.</p>
<p>Once installed please check that no errors show from the command:</p>
<div class="highlight"><pre><span></span><code>~/klippy-env/bin/python -c &#39;import numpy;&#39;
</code></pre></div>

<p>The correct output should simply be a new line.</p>
<h4 id="configure-adxl345-with-rpi">Configure ADXL345 With RPi<a class="headerlink" href="#configure-adxl345-with-rpi" title="Permanent link">&para;</a></h4>
<p>First, check and follow the instructions in the
<a href="RPi_microcontroller.html">RPi Microcontroller document</a> to setup the
"linux mcu" on the Raspberry Pi. This will configure a second Klipper
instance that runs on your Pi.</p>
<p>Make sure the Linux SPI driver is enabled by running <code>sudo
raspi-config</code> and enabling SPI under the "Interfacing options" menu.</p>
<p>Add the following to the printer.cfg file:</p>
<div class="highlight"><pre><span></span><code>[mcu rpi]
serial: /tmp/klipper_host_mcu

[adxl345]
cs_pin: rpi:None

[resonance_tester]
accel_chip: adxl345
probe_points:
    100, 100, 20  # an example
</code></pre></div>

<p>It is advised to start with 1 probe point, in the middle of the print bed,
slightly above it.</p>
<h4 id="configure-adxl345-with-pi-pico">Configure ADXL345 With Pi Pico<a class="headerlink" href="#configure-adxl345-with-pi-pico" title="Permanent link">&para;</a></h4>
<h5 id="flash-the-pico-firmware">Flash the Pico Firmware<a class="headerlink" href="#flash-the-pico-firmware" title="Permanent link">&para;</a></h5>
<p>On your Raspberry Pi, compile the firmware for the Pico.</p>
<div class="highlight"><pre><span></span><code>cd ~/klipper
make clean
make menuconfig
</code></pre></div>

<p><img alt="Pico menuconfig" src="img/klipper_pico_menuconfig.png" /></p>
<p>Now, while holding down the <code>BOOTSEL</code> button on the Pico, connect the Pico to
the Raspberry Pi via USB. Compile and flash the firmware.</p>
<div class="highlight"><pre><span></span><code>make flash FLASH_DEVICE=first
</code></pre></div>

<p>If that fails, you will be told which <code>FLASH_DEVICE</code> to use. In this example,
that's <code>make flash FLASH_DEVICE=2e8a:0003</code>.
<img alt="Determine flash device" src="img/flash_rp2040_FLASH_DEVICE.png" /></p>
<h5 id="configure-the-connection">Configure the Connection<a class="headerlink" href="#configure-the-connection" title="Permanent link">&para;</a></h5>
<p>The Pico will now reboot with the new firmware and should show up as a serial
device. Find the pico serial device with <code>ls /dev/serial/by-id/*</code>. You can
now add an <code>adxl.cfg</code> file with the following settings:</p>
<div class="highlight"><pre><span></span><code>[mcu adxl]
# Change &lt;mySerial&gt; to whatever you found above. For example,
# usb-Klipper_rp2040_E661640843545B2E-if00
serial: /dev/serial/by-id/usb-Klipper_rp2040_&lt;mySerial&gt;

[adxl345]
cs_pin: adxl:gpio1
spi_bus: spi0a
axes_map: x,z,y

[resonance_tester]
accel_chip: adxl345
probe_points:
    # Somewhere slightly above the middle of your print bed
    147,154, 20

[output_pin power_mode] # Improve power stability
pin: adxl:gpio23
</code></pre></div>

<p>If setting up the ADXL345 configuration in a separate file, as shown above,
you'll also want to modify your <code>printer.cfg</code> file to include this:</p>
<div class="highlight"><pre><span></span><code>[include adxl.cfg] # Comment this out when you disconnect the accelerometer
</code></pre></div>

<p>Restart Klipper via the <code>RESTART</code> command.</p>
<h4 id="configure-lis2dw-series">Configure LIS2DW series<a class="headerlink" href="#configure-lis2dw-series" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>[mcu lis]
# Change &lt;mySerial&gt; to whatever you found above. For example,
# usb-Klipper_rp2040_E661640843545B2E-if00
serial: /dev/serial/by-id/usb-Klipper_rp2040_&lt;mySerial&gt;

[lis2dw]
cs_pin: lis:gpio1
spi_bus: spi0a
axes_map: x,z,y

[resonance_tester]
accel_chip: lis2dw
probe_points:
    # Somewhere slightly above the middle of your print bed
    147,154, 20
</code></pre></div>

<h4 id="configure-mpu-60009000-series-with-rpi">Configure MPU-6000/9000 series With RPi<a class="headerlink" href="#configure-mpu-60009000-series-with-rpi" title="Permanent link">&para;</a></h4>
<p>Make sure the Linux I2C driver is enabled and the baud rate is
set to 400000 (see <a href="RPi_microcontroller.html#optional-enabling-i2c">Enabling I2C</a>
section for more details). Then, add the following to the printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu rpi]
serial: /tmp/klipper_host_mcu

[mpu9250]
i2c_mcu: rpi
i2c_bus: i2c.1

[resonance_tester]
accel_chip: mpu9250
probe_points:
    100, 100, 20  # an example
</code></pre></div>

<h4 id="configure-mpu-9520-compatibles-with-pico">Configure MPU-9520 Compatibles With Pico<a class="headerlink" href="#configure-mpu-9520-compatibles-with-pico" title="Permanent link">&para;</a></h4>
<p>Pico I2C is set to 400000 on default. Simply add the following to the
printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu pico]
serial: /dev/serial/by-id/&lt;your Pico&#39;s serial ID&gt;

[mpu9250]
i2c_mcu: pico
i2c_bus: i2c0a

[resonance_tester]
accel_chip: mpu9250
probe_points:
    100, 100, 20  # an example

[static_digital_output pico_3V3pwm] # Improve power stability
pins: pico:gpio23
</code></pre></div>

<h4 id="configure-mpu-9520-compatibles-with-avr">Configure MPU-9520 Compatibles with AVR<a class="headerlink" href="#configure-mpu-9520-compatibles-with-avr" title="Permanent link">&para;</a></h4>
<p>AVR I2C will be set to 400000 by the mpu9250 option. Simply add the following
to the printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu nano]
serial: /dev/serial/by-id/&lt;your nano&#39;s serial ID&gt;

[mpu9250]
i2c_mcu: nano

[resonance_tester]
accel_chip: mpu9250
probe_points:
    100, 100, 20  # an example
</code></pre></div>

<p>Restart Klipper via the <code>RESTART</code> command.</p>
<h2 id="measuring-the-resonances">Measuring the resonances<a class="headerlink" href="#measuring-the-resonances" title="Permanent link">&para;</a></h2>
<h3 id="checking-the-setup">Checking the setup<a class="headerlink" href="#checking-the-setup" title="Permanent link">&para;</a></h3>
<p>Now you can test a connection.</p>
<ul>
<li>For "non bed-slingers" (e.g. one accelerometer), in Octoprint,
  enter <code>ACCELEROMETER_QUERY</code></li>
<li>For "bed-slingers" (e.g. more than one accelerometer), enter
  <code>ACCELEROMETER_QUERY CHIP=&lt;chip&gt;</code> where <code>&lt;chip&gt;</code> is the name of the chip
  as-entered, e.g. <code>CHIP=bed</code> (see: <a href="#bed-slinger-printers">bed-slinger</a>)
  for all installed accelerometer chips.</li>
</ul>
<p>You should see the current measurements from the accelerometer, including the
free-fall acceleration, e.g.</p>
<div class="highlight"><pre><span></span><code>Recv: // adxl345 values (x, y, z): 470.719200, 941.438400, 9728.196800
</code></pre></div>

<p>If you get an error like <code>Invalid adxl345 id (got xx vs e5)</code>, where <code>xx</code>
is some other ID, immediately try again. There's an issue with SPI
initialization. If you still get an error, it is indicative of the connection
problem with ADXL345,
or the faulty sensor. Double-check the power, the wiring (that it matches
the schematics, no wire is broken or loose, etc.), and soldering quality.</p>
<p><strong>If you are using a MPU-9250 compatible accelerometer and it shows up as
<code>mpu-unknown</code>, use with caution! They are probably refurbished chips!</strong></p>
<p>Next, try running <code>MEASURE_AXES_NOISE</code> in Octoprint, you should get some
baseline numbers for the noise of accelerometer on the axes (should be
somewhere in the range of ~1-100). Too high axes noise (e.g. 1000 and more)
can be indicative of the sensor issues, problems with its power, or too
noisy imbalanced fans on a 3D printer.</p>
<h3 id="measuring-the-resonances_1">Measuring the resonances<a class="headerlink" href="#measuring-the-resonances_1" title="Permanent link">&para;</a></h3>
<p>Now you can run some real-life tests. Run the following command:</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=X
</code></pre></div>

<p>Note that it will create vibrations on X axis. It will also disable input
shaping if it was enabled previously, as it is not valid to run the resonance
testing with the input shaper enabled.</p>
<p><strong>Attention!</strong> Be sure to observe the printer for the first time, to make sure
the vibrations do not become too violent (<code>M112</code> command can be used to abort
the test in case of emergency; hopefully it will not come to this though).
If the vibrations do get too strong, you can attempt to specify a lower than the
default value for <code>accel_per_hz</code> parameter in <code>[resonance_tester]</code> section, e.g.</p>
<div class="highlight"><pre><span></span><code>[resonance_tester]
accel_chip: adxl345
accel_per_hz: 50  # default is 75
probe_points: ...
</code></pre></div>

<p>If it works for X axis, run for Y axis as well:</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=Y
</code></pre></div>

<p>This will generate 2 CSV files (<code>/tmp/resonances_x_*.csv</code> and
<code>/tmp/resonances_y_*.csv</code>). These files can be processed with the stand-alone
script on a Raspberry Pi. This script is intended to be run with a single CSV
file for each axis measured, although it can be used with multiple CSV files
if you desire to average the results. Averaging results can be useful, for
example, if resonance tests were done at multiple test points. Delete the extra
CSV files if you do not desire to average them.</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/calibrate_shaper.py /tmp/resonances_x_*.csv -o /tmp/shaper_calibrate_x.png
~/klipper/scripts/calibrate_shaper.py /tmp/resonances_y_*.csv -o /tmp/shaper_calibrate_y.png
</code></pre></div>

<p>This script will generate the charts <code>/tmp/shaper_calibrate_x.png</code> and
<code>/tmp/shaper_calibrate_y.png</code> with frequency responses. You will also get the
suggested frequencies for each input shaper, as well as which input shaper is
recommended for your setup. For example:</p>
<p><img alt="Resonances" src="img/calibrate-y.png" /></p>
<div class="highlight"><pre><span></span><code>Fitted shaper &#39;zv&#39; frequency = 34.4 Hz (vibrations = 4.0%, smoothing ~= 0.132)
To avoid too much smoothing with &#39;zv&#39;, suggested max_accel &lt;= 4500 mm/sec^2
Fitted shaper &#39;mzv&#39; frequency = 34.6 Hz (vibrations = 0.0%, smoothing ~= 0.170)
To avoid too much smoothing with &#39;mzv&#39;, suggested max_accel &lt;= 3500 mm/sec^2
Fitted shaper &#39;ei&#39; frequency = 41.4 Hz (vibrations = 0.0%, smoothing ~= 0.188)
To avoid too much smoothing with &#39;ei&#39;, suggested max_accel &lt;= 3200 mm/sec^2
Fitted shaper &#39;2hump_ei&#39; frequency = 51.8 Hz (vibrations = 0.0%, smoothing ~= 0.201)
To avoid too much smoothing with &#39;2hump_ei&#39;, suggested max_accel &lt;= 3000 mm/sec^2
Fitted shaper &#39;3hump_ei&#39; frequency = 61.8 Hz (vibrations = 0.0%, smoothing ~= 0.215)
To avoid too much smoothing with &#39;3hump_ei&#39;, suggested max_accel &lt;= 2800 mm/sec^2
Recommended shaper is mzv @ 34.6 Hz
</code></pre></div>

<p>The suggested configuration can be added to <code>[input_shaper]</code> section of
<code>printer.cfg</code>, e.g.:</p>
<div class="highlight"><pre><span></span><code>[input_shaper]
shaper_freq_x: ...
shaper_type_x: ...
shaper_freq_y: 34.6
shaper_type_y: mzv

[printer]
max_accel: 3000  # should not exceed the estimated max_accel for X and Y axes
</code></pre></div>

<p>or you can choose some other configuration yourself based on the generated
charts: peaks in the power spectral density on the charts correspond to
the resonance frequencies of the printer.</p>
<p>Note that alternatively you can run the input shaper auto-calibration
from Klipper <a href="#input-shaper-auto-calibration">directly</a>, which can be
convenient, for example, for the input shaper
<a href="#input-shaper-re-calibration">re-calibration</a>.</p>
<h3 id="bed-slinger-printers">Bed-slinger printers<a class="headerlink" href="#bed-slinger-printers" title="Permanent link">&para;</a></h3>
<p>If your printer is a bed slinger printer, you will need to change the location
of the accelerometer between the measurements for X and Y axes: measure the
resonances of X axis with the accelerometer attached to the toolhead and the
resonances of Y axis - to the bed (the usual bed slinger setup).</p>
<p>However, you can also connect two accelerometers simultaneously, though the
ADXL345 must be connected to different boards (say, to an RPi and printer MCU
board), or to two different physical SPI interfaces on the same board (rarely
available). Then they can be configured in the following manner:</p>
<div class="highlight"><pre><span></span><code>[adxl345 hotend]
# Assuming `hotend` chip is connected to an RPi
cs_pin: rpi:None

[adxl345 bed]
# Assuming `bed` chip is connected to a printer MCU board
cs_pin: ...  # Printer board SPI chip select (CS) pin

[resonance_tester]
# Assuming the typical setup of the bed slinger printer
accel_chip_x: adxl345 hotend
accel_chip_y: adxl345 bed
probe_points: ...
</code></pre></div>

<p>Two MPUs can share one I2C bus, but they <strong>cannot</strong> measure simultaneously as
the 400kbit/s I2C bus is not fast enough. One must have its AD0 pin pulled-down
to 0V (address 104) and the other its AD0 pin pulled-up to 3.3V (address 105):</p>
<div class="highlight"><pre><span></span><code>[mpu9250 hotend]
i2c_mcu: rpi
i2c_bus: i2c.1
i2c_address: 104 # This MPU has pin AD0 pulled low

[mpu9250 bed]
i2c_mcu: rpi
i2c_bus: i2c.1
i2c_address: 105 # This MPU has pin AD0 pulled high

[resonance_tester]
# Assuming the typical setup of the bed slinger printer
accel_chip_x: mpu9250 hotend
accel_chip_y: mpu9250 bed
probe_points: ...
</code></pre></div>

<p>[Test with each MPU individually before connecting both to the bus for easy
debugging.]</p>
<p>Then the commands <code>TEST_RESONANCES AXIS=X</code> and <code>TEST_RESONANCES AXIS=Y</code>
will use the correct accelerometer for each axis.</p>
<h3 id="max-smoothing">Max smoothing<a class="headerlink" href="#max-smoothing" title="Permanent link">&para;</a></h3>
<p>Keep in mind that the input shaper can create some smoothing in parts.
Automatic tuning of the input shaper performed by <code>calibrate_shaper.py</code>
script or <code>SHAPER_CALIBRATE</code> command tries not to exacerbate the smoothing,
but at the same time they try to minimize the resulting vibrations.
Sometimes they can make a sub-optimal choice of the shaper frequency, or
maybe you simply prefer to have less smoothing in parts at the expense of
a larger remaining vibrations. In these cases, you can request to limit
the maximum smoothing from the input shaper.</p>
<p>Let's consider the following results from the automatic tuning:</p>
<p><img alt="Resonances" src="img/calibrate-x.png" /></p>
<div class="highlight"><pre><span></span><code>Fitted shaper &#39;zv&#39; frequency = 57.8 Hz (vibrations = 20.3%, smoothing ~= 0.053)
To avoid too much smoothing with &#39;zv&#39;, suggested max_accel &lt;= 13000 mm/sec^2
Fitted shaper &#39;mzv&#39; frequency = 34.8 Hz (vibrations = 3.6%, smoothing ~= 0.168)
To avoid too much smoothing with &#39;mzv&#39;, suggested max_accel &lt;= 3600 mm/sec^2
Fitted shaper &#39;ei&#39; frequency = 48.8 Hz (vibrations = 4.9%, smoothing ~= 0.135)
To avoid too much smoothing with &#39;ei&#39;, suggested max_accel &lt;= 4400 mm/sec^2
Fitted shaper &#39;2hump_ei&#39; frequency = 45.2 Hz (vibrations = 0.1%, smoothing ~= 0.264)
To avoid too much smoothing with &#39;2hump_ei&#39;, suggested max_accel &lt;= 2200 mm/sec^2
Fitted shaper &#39;3hump_ei&#39; frequency = 48.0 Hz (vibrations = 0.0%, smoothing ~= 0.356)
To avoid too much smoothing with &#39;3hump_ei&#39;, suggested max_accel &lt;= 1500 mm/sec^2
Recommended shaper is 2hump_ei @ 45.2 Hz
</code></pre></div>

<p>Note that the reported <code>smoothing</code> values are some abstract projected values.
These values can be used to compare different configurations: the higher the
value, the more smoothing a shaper will create. However, these smoothing scores
do not represent any real measure of smoothing, because the actual smoothing
depends on <a href="#selecting-max-accel"><code>max_accel</code></a> and <code>square_corner_velocity</code>
parameters. Therefore, you should print some test prints to see how much
smoothing exactly a chosen configuration creates.</p>
<p>In the example above the suggested shaper parameters are not bad, but what if
you want to get less smoothing on the X axis? You can try to limit the maximum
shaper smoothing using the following command:</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/calibrate_shaper.py /tmp/resonances_x_*.csv -o /tmp/shaper_calibrate_x.png --max_smoothing=0.2
</code></pre></div>

<p>which limits the smoothing to 0.2 score. Now you can get the following result:</p>
<p><img alt="Resonances" src="img/calibrate-x-max-smoothing.png" /></p>
<div class="highlight"><pre><span></span><code>Fitted shaper &#39;zv&#39; frequency = 55.4 Hz (vibrations = 19.7%, smoothing ~= 0.057)
To avoid too much smoothing with &#39;zv&#39;, suggested max_accel &lt;= 12000 mm/sec^2
Fitted shaper &#39;mzv&#39; frequency = 34.6 Hz (vibrations = 3.6%, smoothing ~= 0.170)
To avoid too much smoothing with &#39;mzv&#39;, suggested max_accel &lt;= 3500 mm/sec^2
Fitted shaper &#39;ei&#39; frequency = 48.2 Hz (vibrations = 4.8%, smoothing ~= 0.139)
To avoid too much smoothing with &#39;ei&#39;, suggested max_accel &lt;= 4300 mm/sec^2
Fitted shaper &#39;2hump_ei&#39; frequency = 52.0 Hz (vibrations = 2.7%, smoothing ~= 0.200)
To avoid too much smoothing with &#39;2hump_ei&#39;, suggested max_accel &lt;= 3000 mm/sec^2
Fitted shaper &#39;3hump_ei&#39; frequency = 72.6 Hz (vibrations = 1.4%, smoothing ~= 0.155)
To avoid too much smoothing with &#39;3hump_ei&#39;, suggested max_accel &lt;= 3900 mm/sec^2
Recommended shaper is 3hump_ei @ 72.6 Hz
</code></pre></div>

<p>If you compare to the previously suggested parameters, the vibrations are a bit
larger, but the smoothing is significantly smaller than previously, allowing
larger maximum acceleration.</p>
<p>When deciding which <code>max_smoothing</code> parameter to choose, you can use a
trial-and-error approach. Try a few different values and see which results
you get. Note that the actual smoothing produced by the input shaper depends,
primarily, on the lowest resonance frequency of the printer: the higher
the frequency of the lowest resonance - the smaller the smoothing. Therefore,
if you request the script to find a configuration of the input shaper with the
unrealistically small smoothing, it will be at the expense of increased ringing
at the lowest resonance frequencies (which are, typically, also more prominently
visible in prints). So, always double-check the projected remaining vibrations
reported by the script and make sure they are not too high.</p>
<p>Note that if you chose a good <code>max_smoothing</code> value for both of your axes, you
can store it in the <code>printer.cfg</code> as</p>
<div class="highlight"><pre><span></span><code>[resonance_tester]
accel_chip: ...
probe_points: ...
max_smoothing: 0.25  # an example
</code></pre></div>

<p>Then, if you <a href="#input-shaper-re-calibration">rerun</a> the input shaper auto-tuning
using <code>SHAPER_CALIBRATE</code> Klipper command in the future, it will use the stored
<code>max_smoothing</code> value as a reference.</p>
<h3 id="selecting-max_accel">Selecting max_accel<a class="headerlink" href="#selecting-max_accel" title="Permanent link">&para;</a></h3>
<p>Since the input shaper can create some smoothing in parts, especially at high
accelerations, you will still need to choose the <code>max_accel</code> value that
does not create too much smoothing in the printed parts. A calibration script
provides an estimate for <code>max_accel</code> parameter that should not create too much
smoothing. Note that the <code>max_accel</code> as displayed by the calibration script is
only a theoretical maximum at which the respective shaper is still able to work
without producing too much smoothing. It is by no means a recommendation to set
this acceleration for printing. The maximum acceleration your printer is able to
sustain depends on its mechanical properties and the maximum torque of the used
stepper motors. Therefore, it is suggested to set <code>max_accel</code> in <code>[printer]</code>
section that does not exceed the estimated values for X and Y axes, likely with
some conservative safety margin.</p>
<p>Alternatively, follow
<a href="Resonance_Compensation.html#selecting-max_accel">this</a> part of
the input shaper tuning guide and print the test model to choose <code>max_accel</code>
parameter experimentally.</p>
<p>The same notice applies to the input shaper
<a href="#input-shaper-auto-calibration">auto-calibration</a> with
<code>SHAPER_CALIBRATE</code> command: it is still necessary to choose the right
<code>max_accel</code> value after the auto-calibration, and the suggested acceleration
limits will not be applied automatically.</p>
<p>Keep in mind that the maximum acceleration without too much smoothing depends
on the <code>square_corner_velocity</code>. The general recommendation is not to change
it from its default value 5.0, and this is the value used by default by the
<code>calibrate_shaper.py</code> script. If you did change it though, you should inform
the script about it by passing <code>--square_corner_velocity=...</code> parameter, e.g.</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/calibrate_shaper.py /tmp/resonances_x_*.csv -o /tmp/shaper_calibrate_x.png --square_corner_velocity=10.0
</code></pre></div>

<p>so that it can calculate the maximum acceleration recommendations correctly.
Note that the <code>SHAPER_CALIBRATE</code> command already takes the configured
<code>square_corner_velocity</code> parameter into account, and there is no need
to specify it explicitly.</p>
<p>If you are doing a shaper re-calibration and the reported smoothing for the
suggested shaper configuration is almost the same as what you got during the
previous calibration, this step can be skipped.</p>
<h3 id="testing-custom-axes">Testing custom axes<a class="headerlink" href="#testing-custom-axes" title="Permanent link">&para;</a></h3>
<p><code>TEST_RESONANCES</code> command supports custom axes. While this is not really
useful for input shaper calibration, it can be used to study printer
resonances in-depth and to check, for example, belt tension.</p>
<p>To check the belt tension on CoreXY printers, execute</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=1,1 OUTPUT=raw_data
TEST_RESONANCES AXIS=1,-1 OUTPUT=raw_data
</code></pre></div>

<p>and use <code>graph_accelerometer.py</code> to process the generated files, e.g.</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/graph_accelerometer.py -c /tmp/raw_data_axis*.csv -o /tmp/resonances.png
</code></pre></div>

<p>which will generate <code>/tmp/resonances.png</code> comparing the resonances.</p>
<p>For Delta printers with the default tower placement
(tower A ~= 210 degrees, B ~= 330 degrees, and C ~= 90 degrees), execute</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=0,1 OUTPUT=raw_data
TEST_RESONANCES AXIS=-0.866025404,-0.5 OUTPUT=raw_data
TEST_RESONANCES AXIS=0.866025404,-0.5 OUTPUT=raw_data
</code></pre></div>

<p>and then use the same command</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/graph_accelerometer.py -c /tmp/raw_data_axis*.csv -o /tmp/resonances.png
</code></pre></div>

<p>to generate <code>/tmp/resonances.png</code> comparing the resonances.</p>
<h2 id="input-shaper-auto-calibration">Input Shaper auto-calibration<a class="headerlink" href="#input-shaper-auto-calibration" title="Permanent link">&para;</a></h2>
<p>Besides manually choosing the appropriate parameters for the input shaper
feature, it is also possible to run the auto-tuning for the input shaper
directly from Klipper. Run the following command via Octoprint terminal:</p>
<div class="highlight"><pre><span></span><code>SHAPER_CALIBRATE
</code></pre></div>

<p>This will run the full test for both axes and generate the csv output
(<code>/tmp/calibration_data_*.csv</code> by default) for the frequency response
and the suggested input shapers. You will also get the suggested
frequencies for each input shaper, as well as which input shaper is
recommended for your setup, on Octoprint console. For example:</p>
<div class="highlight"><pre><span></span><code>Calculating the best input shaper parameters for y axis
Fitted shaper &#39;zv&#39; frequency = 39.0 Hz (vibrations = 13.2%, smoothing ~= 0.105)
To avoid too much smoothing with &#39;zv&#39;, suggested max_accel &lt;= 5900 mm/sec^2
Fitted shaper &#39;mzv&#39; frequency = 36.8 Hz (vibrations = 1.7%, smoothing ~= 0.150)
To avoid too much smoothing with &#39;mzv&#39;, suggested max_accel &lt;= 4000 mm/sec^2
Fitted shaper &#39;ei&#39; frequency = 36.6 Hz (vibrations = 2.2%, smoothing ~= 0.240)
To avoid too much smoothing with &#39;ei&#39;, suggested max_accel &lt;= 2500 mm/sec^2
Fitted shaper &#39;2hump_ei&#39; frequency = 48.0 Hz (vibrations = 0.0%, smoothing ~= 0.234)
To avoid too much smoothing with &#39;2hump_ei&#39;, suggested max_accel &lt;= 2500 mm/sec^2
Fitted shaper &#39;3hump_ei&#39; frequency = 59.0 Hz (vibrations = 0.0%, smoothing ~= 0.235)
To avoid too much smoothing with &#39;3hump_ei&#39;, suggested max_accel &lt;= 2500 mm/sec^2
Recommended shaper_type_y = mzv, shaper_freq_y = 36.8 Hz
</code></pre></div>

<p>If you agree with the suggested parameters, you can execute <code>SAVE_CONFIG</code>
now to save them and restart the Klipper. Note that this will not update
<code>max_accel</code> value in <code>[printer]</code> section. You should update it manually
following the considerations in <a href="#selecting-max_accel">Selecting max_accel</a>
section.</p>
<p>If your printer is a bed slinger printer, you can specify which axis
to test, so that you can change the accelerometer mounting point between
the tests (by default the test is performed for both axes):</p>
<div class="highlight"><pre><span></span><code>SHAPER_CALIBRATE AXIS=Y
</code></pre></div>

<p>You can execute <code>SAVE_CONFIG</code> twice - after calibrating each axis.</p>
<p>However, if you connected two accelerometers simultaneously, you simply run
<code>SHAPER_CALIBRATE</code> without specifying an axis to calibrate the input shaper
for both axes in one go.</p>
<h3 id="input-shaper-re-calibration">Input Shaper re-calibration<a class="headerlink" href="#input-shaper-re-calibration" title="Permanent link">&para;</a></h3>
<p><code>SHAPER_CALIBRATE</code> command can be also used to re-calibrate the input shaper in
the future, especially if some changes to the printer that can affect its
kinematics are made. One can either re-run the full calibration using
<code>SHAPER_CALIBRATE</code> command, or restrict the auto-calibration to a single axis by
supplying <code>AXIS=</code> parameter, like</p>
<div class="highlight"><pre><span></span><code>SHAPER_CALIBRATE AXIS=X
</code></pre></div>

<p><strong>Warning!</strong> It is not advisable to run the shaper auto-calibration very
frequently (e.g. before every print, or every day). In order to determine
resonance frequencies, auto-calibration creates intensive vibrations on each of
the axes. Generally, 3D printers are not designed to withstand a prolonged
exposure to vibrations near the resonance frequencies. Doing so may increase
wear of the printer components and reduce their lifespan. There is also an
increased risk of some parts unscrewing or becoming loose. Always check that
all parts of the printer (including the ones that may normally not move) are
securely fixed in place after each auto-tuning.</p>
<p>Also, due to some noise in measurements, it is possible that the tuning results
will be slightly different from one calibration run to another one. Still, it
is not expected that the noise will affect the print quality too much.
However, it is still advised to double-check the suggested parameters, and
print some test prints before using them to confirm they are good.</p>
<h2 id="offline-processing-of-the-accelerometer-data">Offline processing of the accelerometer data<a class="headerlink" href="#offline-processing-of-the-accelerometer-data" title="Permanent link">&para;</a></h2>
<p>It is possible to generate the raw accelerometer data and process it offline
(e.g. on a host machine), for example to find resonances. In order to do so,
run the following commands via Octoprint terminal:</p>
<div class="highlight"><pre><span></span><code>SET_INPUT_SHAPER SHAPER_FREQ_X=0 SHAPER_FREQ_Y=0
TEST_RESONANCES AXIS=X OUTPUT=raw_data
</code></pre></div>

<p>ignoring any errors for <code>SET_INPUT_SHAPER</code> command. For <code>TEST_RESONANCES</code>
command, specify the desired test axis. The raw data will be written into
<code>/tmp</code> directory on the RPi.</p>
<p>The raw data can also be obtained by running the command
<code>ACCELEROMETER_MEASURE</code> command twice during some normal printer
activity - first to start the measurements, and then to stop them and
write the output file. Refer to <a href="G-Codes.html#adxl345">G-Codes</a> for more
details.</p>
<p>The data can be processed later by the following scripts:
<code>scripts/graph_accelerometer.py</code> and <code>scripts/calibrate_shaper.py</code>. Both
of them accept one or several raw csv files as the input depending on the
mode. The graph_accelerometer.py script supports several modes of operation:</p>
<ul>
<li>plotting raw accelerometer data (use <code>-r</code> parameter), only 1 input is
  supported;</li>
<li>plotting a frequency response (no extra parameters required), if multiple
  inputs are specified, the average frequency response is computed;</li>
<li>comparison of the frequency response between several inputs (use <code>-c</code>
  parameter); you can additionally specify which accelerometer axis to
    consider via <code>-a x</code>, <code>-a y</code> or <code>-a z</code> parameter (if none specified,
    the sum of vibrations for all axes is used);</li>
<li>plotting the spectrogram (use <code>-s</code> parameter), only 1 input is supported;
  you can additionally specify which accelerometer axis to consider via
  <code>-a x</code>, <code>-a y</code> or <code>-a z</code> parameter (if none specified, the sum of vibrations
  for all axes is used).</li>
</ul>
<p>Note that graph_accelerometer.py script supports only the raw_data*.csv files
and not resonances*.csv or calibration_data*.csv files.</p>
<p>For example,</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/graph_accelerometer.py /tmp/raw_data_x_*.csv -o /tmp/resonances_x.png -c -a z
</code></pre></div>

<p>will plot the comparison of several <code>/tmp/raw_data_x_*.csv</code> files for Z axis to
<code>/tmp/resonances_x.png</code> file.</p>
<p>The shaper_calibrate.py script accepts 1 or several inputs and can run automatic
tuning of the input shaper and suggest the best parameters that work well for
all provided inputs. It prints the suggested parameters to the console, and can
additionally generate the chart if <code>-o output.png</code> parameter is provided, or
the CSV file if <code>-c output.csv</code> parameter is specified.</p>
<p>Providing several inputs to shaper_calibrate.py script can be useful if running
some advanced tuning of the input shapers, for example:</p>
<ul>
<li>Running <code>TEST_RESONANCES AXIS=X OUTPUT=raw_data</code> (and <code>Y</code> axis) for a single
  axis twice on a bed slinger printer with the accelerometer attached to the
  toolhead the first time, and the accelerometer attached to the bed the
  second time in order to detect axes cross-resonances and attempt to cancel
  them with input shapers.</li>
<li>Running <code>TEST_RESONANCES AXIS=Y OUTPUT=raw_data</code> twice on a bed slinger with
  a glass bed and a magnetic surfaces (which is lighter) to find the input
  shaper parameters that work well for any print surface configuration.</li>
<li>Combining the resonance data from multiple test points.</li>
<li>Combining the resonance data from 2 axis (e.g. on a bed slinger printer
  to configure X-axis input_shaper from both X and Y axes resonances to
  cancel vibrations of the <em>bed</em> in case the nozzle 'catches' a print when
  moving in X axis direction).</li>
</ul>









  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.top", "search.suggest", "search.highlight", "search.share"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.ebd0bdb7.min.js"></script>
      
    
  </body>
</html>